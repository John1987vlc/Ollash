{% extends 'base.html' %}

{% block title %}WASM Sandbox - Ollash{% endblock %}

{% block styles %}
<style>
    .sandbox-layout {
        display: flex;
        flex-direction: column;
        height: calc(100vh - 160px);
        gap: var(--spacing-md);
        margin-top: var(--spacing-md);
    }

    .editor-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--color-surface);
        padding: var(--spacing-sm) var(--spacing-md);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-md);
    }

    .sandbox-panels {
        display: grid;
        grid-template-columns: 1fr 1fr;
        flex: 1;
        gap: var(--spacing-md);
        min-height: 0;
    }

    #monaco-editor-container {
        border: 1px solid var(--color-border);
        border-radius: var(--radius-md);
        overflow: hidden;
        background: #1e1e1e; /* Monaco default dark */
    }

    .terminal-output {
        background: #0c0c0c;
        border: 1px solid var(--color-border);
        border-radius: var(--radius-md);
        padding: var(--spacing-md);
        font-family: var(--font-mono);
        color: #d1d1d1;
        overflow-y: auto;
        white-space: pre-wrap;
        position: relative;
    }

    .terminal-header {
        position: sticky;
        top: 0;
        background: #0c0c0c;
        border-bottom: 1px solid #333;
        padding-bottom: var(--spacing-xs);
        margin-bottom: var(--spacing-sm);
        font-size: 0.75rem;
        color: var(--color-text-subtle);
        display: flex;
        justify-content: space-between;
    }

    .run-button {
        position: fixed;
        bottom: 40px;
        right: 40px;
        z-index: 100;
        padding: 12px 24px;
        border-radius: 30px;
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 700;
        box-shadow: 0 10px 20px rgba(99, 102, 241, 0.4);
    }

    .status-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 6px;
    }
    .status-online { background: var(--color-success); box-shadow: 0 0 8px var(--color-success); }
</style>
{% endblock %}

{% block content %}
<div class="view-header">
    <h1>Safe Execution Sandbox</h1>
    <p class="subtitle">Execute code in an isolated WASM or Docker environment.</p>
</div>

<div class="sandbox-layout">
    <div class="editor-controls">
        <div style="display: flex; gap: var(--spacing-md); align-items: center;">
            <span class="status-indicator status-online"></span>
            <span style="font-size: 0.85rem; font-weight: 500;">Environment: <strong id="env-name">WASM/Docker Hybrid</strong></span>
            
            <select id="language-select" class="btn-secondary" style="padding: 4px 12px; font-size: 0.8rem;">
                <option value="python">Python 3.10</option>
                <option value="javascript">Node.js 18</option>
            </select>
        </div>
        
        <div style="display: flex; gap: var(--spacing-sm);">
            <button class="btn-secondary" id="clear-btn" style="padding: 6px 12px; font-size: 0.8rem;">Clear Output</button>
            <button class="btn-secondary" id="reset-btn" style="padding: 6px 12px; font-size: 0.8rem;">Reset Code</button>
        </div>
    </div>

    <div class="sandbox-panels">
        <div id="monaco-editor-container"></div>
        
        <div class="terminal-output" id="terminal-output">
            <div class="terminal-header">
                <span>TERMINAL OUTPUT</span>
                <span id="exec-time"></span>
            </div>
            <div id="output-content" style="color: #6366f1;">// Ready to execute...</div>
        </div>
    </div>
</div>

<button class="btn-primary run-button btn-pulse" id="run-sandbox-btn">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M8 5v14l11-7z"></path>
    </svg>
    RUN IN SECURE ENVIRONMENT
</button>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/pages/sandbox.js') }}"></script>
{% endblock %}
